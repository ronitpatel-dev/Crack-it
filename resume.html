<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder - Crack-It</title>
    <link rel="stylesheet" href="CSS/resume.css">
</head>

<body>
    <header>
        <nav>
            <span id="logo1">Crack-It</span>
            <ul>
                <li><a href="Home.html">Home</a></li>
                <li><a href="index.html">log-out</a></li>
                
            </ul>
        </nav>
    </header>

    <!-- Resume Builder Section -->
    <div id="ResBuilder">
        <h1>Resume Builder</h1>
        <div class="resume-form">
            <h2>Enter Your Details</h2>
            <form id="resumeForm">
                <label>Full Name:</label>
                <input type="text" id="name" required>

                <label>Email:</label>
                <input type="email" id="email" required>

                <label>Phone:</label>
                <input type="text" id="phone" required>

                <label>Skills:</label>
                <textarea id="skills" required></textarea>

                <label>Experience:</label>
                <textarea id="experience" required></textarea>

                <button type="button" onclick="generateResume()">Generate Resume</button>
            </form>
        </div>

        <!-- Resume Output -->
        <div id="resumeOutput" style="display:none;">
            <button id="closeBtn" onclick="closeResume()">❌</button>
            <h1 id="rName"></h1>
            <p><b>Email:</b> <span id="rEmail"></span></p>
            <p><b>Phone:</b> <span id="rPhone"></span></p>
            <h3>Skills</h3>
            <p id="rSkills"></p>
            <h3>Experience</h3>
            <p id="rExperience"></p>

            <button onclick="downloadResume()">Download PDF</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

    <!-- JS Functions -->
    <script>
        // Resume Builder
        function generateResume() {
            document.getElementById("rName").innerText = document.getElementById("name").value;
            document.getElementById("rEmail").innerText = document.getElementById("email").value;
            document.getElementById("rPhone").innerText = document.getElementById("phone").value;
            document.getElementById("rSkills").innerText = document.getElementById("skills").value;
            document.getElementById("rExperience").innerText = document.getElementById("experience").value;

            document.getElementById("resumeOutput").style.display = "block";
            document.getElementById("resumeForm").style.display = "none";
        }

        function closeResume() {
            document.getElementById("resumeOutput").style.display = "none";
            document.getElementById("resumeForm").style.display = "block";
        }

        function downloadResume() {
            var element = document.getElementById("resumeOutput");
            html2pdf().from(element).save("My_Resume.pdf");
        }

        function downloadTemplate(path) {
            const link = document.createElement('a');
            link.href = path;
            link.download = path.split('/').pop();
            link.click();
        }

        // ATS Checker - PDF Upload
        async function checkATSfromPDF() {
            const file = document.getElementById("resumeFile").files[0];
            if (!file) {
                alert("Please upload a PDF file!");
                return;
            }

            const fileReader = new FileReader();
            fileReader.onload = async function () {
                const typedarray = new Uint8Array(this.result);
                const pdf = await pdfjsLib.getDocument(typedarray).promise;
                let fullText = "";

                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const content = await page.getTextContent();
                    const strings = content.items.map(item => item.str);
                    fullText += strings.join(" ") + " ";
                }

                fullText = fullText.toLowerCase();

                const keywords = ["skills", "experience", "education", "projects", "certifications"];
                let score = 0;
                keywords.forEach(word => {
                    if (fullText.includes(word)) score++;
                });

                const message = document.getElementById("atsMessage");
                document.getElementById("atsResult").style.display = "block";

                if (score === keywords.length) {
                    message.innerText = "✅ Your resume is ATS-friendly! Good job.";
                    message.style.color = "green";
                } else {
                    message.innerText = `⚠️ Your resume might not be fully ATS-friendly. Missing ${keywords.length - score} key sections.`;
                    message.style.color = "orange";
                }
            };

            fileReader.readAsArrayBuffer(file);
        }
    </script>
</body>

</html>
